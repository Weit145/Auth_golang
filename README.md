# Сервис аутентификации (GoLang)

## Обзор проекта

Этот проект представляет собой сервис аутентификации, написанный на Go. Он использует gRPC для межсервисного взаимодействия и предназначен для работы в качестве микросервиса. Он управляет аутентификацией пользователей, регистрацией, обновлением токенов и другими связанными функциями.

## Используемые технологии

*   **Go**: Основной язык программирования для приложения.
*   **gRPC**: Используется для определения уровня API и связи с другими сервисами. Определения Protobuf получены из внешнего репозитория (`github.com/Weit145/proto-repo`).
*   **cleanenv**: Используется для надежного управления конфигурацией, загружая настройки из YAML-файлов.
*   **slog**: Стандартная библиотека Go для структурированного логирования, обеспечивающая четкий и последовательный вывод логов.
*   **PostgreSQL**: (Предполагается на основе `internal/storage/postgresql`) Вероятно, используется в качестве основного хранилища данных для информации о пользователях.

## Структура проекта

Проект соответствует стандартной компоновке проекта Go:

*   `cmd/`: Содержит основную точку входа в приложение (`main.go`).
*   `config/`: Содержит файлы конфигурации для конкретных сред (например, `local.yaml`).
*   `internal/`: Содержит основную бизнес-логику и внутренние пакеты, включая:
    *   `config/`: Разбор конфигурации.
    *   `domain/`: Основные сущности приложения (например, `user.go`).
    *   `grpc/`: Реализации сервисов gRPC.
    *   `lib/`: Общие служебные библиотеки (например, `jwt`, `logger`).
    *   `service/`: Реализации бизнес-логики для различных потоков аутентификации.
    *   `storage/`: Логика взаимодействия с базой данных, в частности для PostgreSQL.

## Сборка и запуск

### Предварительные требования
*   Установлен Go 1.25.5 или новее.
*   Доступ к приватному репозиторию protobuf `github.com/Weit145/proto-repo`.

### Запуск приложения

Чтобы запустить приложение, выполните следующую команду из корневого каталога проекта:

```bash
go run cmd/main.go
```

Сервер запустится и будет прослушивать gRPC-соединения, обычно на порту `:50051`, как настроено.

### Конфигурация

Настройки приложения управляются через YAML-файлы. По умолчанию используется `config/local.yaml`. Чтобы указать альтернативный файл конфигурации, установите переменную среды `CONFIG_PATH`:

```bash
CONFIG_PATH=/path/to/your/config.yaml go run cmd/main.go
```

## Правила разработки

### Логирование

Проект использует `slog` Go для структурированного логирования.

*   **Локальная среда**: Логи выводятся в текстовом виде в `stdout`.
*   **Продакшн среда**: Логи выводятся в формате JSON в `stdout`.

При логировании ошибок используйте вспомогательную функцию `logger.Err()` для структурированных полей ошибок:

```go
import "github.com/Weit145/Auth_golang/internal/lib/logger"

// ...

log.Error("произошла ошибка", logger.Err(err))
```

### Ответы

Пакет `internal/lib/response` предоставляет стандартизированную структуру для ответов API, указывая на потенциальную будущую или существующую интеграцию с HTTP/REST шлюзом.

### Реализация gRPC

Сервисы gRPC определены в каталоге `internal/grpc`. Основная логика сервиса реализована в структуре `server`, обычно находящейся в `internal/grpc/gateway/server.go`.